<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="./favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sensorgnome Config</title>
    <style>
      p { line-height: 2.5ex; margin-top: 2em; }
      li {line-height: 2.5ex; }
      .submit { width: 8em; height: 3ex; margin: 1em 0px 1em 4em; font-size: 125%; }
      input { font-size: 110%; }
    </style>
  </head>
  <body style="margin: 2em 0px">
    <div style="width: 90%; max-width: 40em; margin: auto; border: 2px solid grey; padding: 10px;">
      <h1>Sensorgnome <!--sgid--> Configuration</h1>
      <h2>Welcome to your new Sensorgnome</h2>
      <form action="/init/set-config" method="post" onSubmit="disableForm()">
          <p>This Sensorgnome has not yet been configured.<br>
              Please enter a Sensorgnome password that will be used
              to secure the Web UI and SSH login.<br>
              The password must be at least 8 characters long and will be checked against a 
              "top-100000 passwords" list.</p>
          </p>
          <label for="password">Sensorgnome Password:</label>
          <input type="text" name="password" id="password" required />
          <p>Enter a "short name" for this Sensorgnome. It will appear in the filename
              of all data files as well as in Sensorgnome lists on the Motus and Sensorgnome sites.<br>
              Short names must be 3-20 characters long and composed of letters, 0-9, and _ (underscore).
          </p>
          <label for="short_name">Short name:</label>
          <input type="text" name="short_name" id="short_name" minlength="3" maxlength="20"
                 pattern="[\p{Letter}0-9_]+" required />
                
          <!--
          <p>Select an encryption mode for the WiFi Hot-Spot<br>
            Note: WPA3 requires Windows 10+, MacOS 10.15+, Android 10+, iOS 13+, Linux kernel 3.8+.<br>
            If you use modern devices WPA3 Enhance Open is a good choice, otherwise choose WPA2-PSK.
          </p>
          <input type="checkbox" name="wifi_mode" value="wpa2" id="wifi_wpa2" checked />
          <label for="wifi_wpa2">WPA2-PSK (encrypted w/password)</label><br>
          <input type="checkbox" name="wifi_mode" value="wpa3open" id="wifi_wpa3-open" />
          <label for="wifi_wpa3-open">WPA3 Enhanced Open (no password but encrypted)</label><br>
          <input type="checkbox" name="wifi_mode" value="wpa3sae" id="wifi_wpa3-sae" />
          <label for="wifi_wpa3-sae">WPA3-SAE (encrypted w/password)</label><br>
          </p>-->
          <p>Enter a password for the WiFi Hot-Spot:</p>
          <label for="wifi_pass">Hot-Spot Password:</label>
          <input type="text" name="wifi_pass" id="wifi_pass" placeholder="wifi password" />

          <p style="color:red; font-weight:bold"><!--message--></p>
          <input class="submit" type="submit" value="Submit" id="submit" />
          <p>Note: form submission takes a good 5 seconds,
            if it hangs forever when using an Android phone please ensure your
            cellular/mobile connection is disabled.</p>
          <p>Sensorgnome IP addresses:</p>
          <ul><!--ipaddrs--></ul>
      </form>
    </div>
  </body>
  <script>
    let submit = document.getElementById('submit')
    function disableForm() {
      submit.disabled = true
      submit.value = 'Submitting...'
      window.setTimeout(function() {
        submit.disabled = false
        submit.value = 'Submit'
      }, 20000)
    }
  </script>
</html>
